{"ast":null,"code":"import { PDFDocument } from 'pdf-lib';\n\n// Standard Magic card dimensions (2.5\" x 3.5\")\nconst CARD_WIDTH = 2.5 * 72; // 180pt\nconst CARD_HEIGHT = 3.5 * 72; // 252pt\n\n// Margins (minimal for cutting)\nconst MARGIN_X = 0.25 * 72; // 18pt\nconst MARGIN_Y = 0.25 * 72; // 18pt\n\nexport const generatePDF = async (cards, paper = {\n  width: 8.5,\n  height: 11.0\n}) => {\n  // Convert inches to points\n  const PAGE_WIDTH = paper.width * 72;\n  const PAGE_HEIGHT = paper.height * 72;\n\n  // Calculate grid spacing\n  const GRID_WIDTH = PAGE_WIDTH - 2 * MARGIN_X;\n  const GRID_HEIGHT = PAGE_HEIGHT - 2 * MARGIN_Y;\n  const CARD_SPACING_X = (GRID_WIDTH - 3 * CARD_WIDTH) / 2;\n  const CARD_SPACING_Y = (GRID_HEIGHT - 3 * CARD_HEIGHT) / 2;\n  const pdfDoc = await PDFDocument.create();\n\n  // Pre-fetch all images as Uint8Array\n  const imageBytesArr = await Promise.all(cards.map(async card => {\n    const response = await fetch(card.imageUrl);\n    const arrayBuffer = await response.arrayBuffer();\n    return new Uint8Array(arrayBuffer);\n  }));\n  for (let i = 0; i < cards.length; i += 9) {\n    const pageCards = cards.slice(i, i + 9);\n    const pageImages = imageBytesArr.slice(i, i + 9);\n    const page = pdfDoc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);\n    for (let j = 0; j < pageCards.length; j++) {\n      const imgBytes = pageImages[j];\n      // Embed image (assume PNG)\n      const img = await pdfDoc.embedPng(imgBytes);\n      const row = Math.floor(j / 3);\n      const col = j % 3;\n      const x = MARGIN_X + col * (CARD_WIDTH + CARD_SPACING_X);\n      const y = PAGE_HEIGHT - MARGIN_Y - CARD_HEIGHT - row * (CARD_HEIGHT + CARD_SPACING_Y);\n      page.drawImage(img, {\n        x,\n        y,\n        width: CARD_WIDTH,\n        height: CARD_HEIGHT\n      });\n    }\n  }\n  const pdfBytes = await pdfDoc.save();\n  // Return as Blob for download\n  return new Blob([pdfBytes], {\n    type: 'application/pdf'\n  });\n};\nexport const downloadPDF = (pdfBlob, filename = 'mtg-deck.pdf') => {\n  const url = URL.createObjectURL(pdfBlob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n};","map":{"version":3,"names":["PDFDocument","CARD_WIDTH","CARD_HEIGHT","MARGIN_X","MARGIN_Y","generatePDF","cards","paper","width","height","PAGE_WIDTH","PAGE_HEIGHT","GRID_WIDTH","GRID_HEIGHT","CARD_SPACING_X","CARD_SPACING_Y","pdfDoc","create","imageBytesArr","Promise","all","map","card","response","fetch","imageUrl","arrayBuffer","Uint8Array","i","length","pageCards","slice","pageImages","page","addPage","j","imgBytes","img","embedPng","row","Math","floor","col","x","y","drawImage","pdfBytes","save","Blob","type","downloadPDF","pdfBlob","filename","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL"],"sources":["C:/MTG/mtg-pdf-printer/mtg-pdf-printer/src/utils/pdfGenerator.js"],"sourcesContent":["import { PDFDocument } from 'pdf-lib';\r\n\r\n// Standard Magic card dimensions (2.5\" x 3.5\")\r\nconst CARD_WIDTH = 2.5 * 72; // 180pt\r\nconst CARD_HEIGHT = 3.5 * 72; // 252pt\r\n\r\n// Margins (minimal for cutting)\r\nconst MARGIN_X = 0.25 * 72; // 18pt\r\nconst MARGIN_Y = 0.25 * 72; // 18pt\r\n\r\nexport const generatePDF = async (cards, paper = { width: 8.5, height: 11.0 }) => {\r\n  // Convert inches to points\r\n  const PAGE_WIDTH = paper.width * 72;\r\n  const PAGE_HEIGHT = paper.height * 72;\r\n\r\n  // Calculate grid spacing\r\n  const GRID_WIDTH = PAGE_WIDTH - (2 * MARGIN_X);\r\n  const GRID_HEIGHT = PAGE_HEIGHT - (2 * MARGIN_Y);\r\n  const CARD_SPACING_X = (GRID_WIDTH - (3 * CARD_WIDTH)) / 2;\r\n  const CARD_SPACING_Y = (GRID_HEIGHT - (3 * CARD_HEIGHT)) / 2;\r\n\r\n  const pdfDoc = await PDFDocument.create();\r\n\r\n  // Pre-fetch all images as Uint8Array\r\n  const imageBytesArr = await Promise.all(\r\n    cards.map(async (card) => {\r\n      const response = await fetch(card.imageUrl);\r\n      const arrayBuffer = await response.arrayBuffer();\r\n      return new Uint8Array(arrayBuffer);\r\n    })\r\n  );\r\n\r\n  for (let i = 0; i < cards.length; i += 9) {\r\n    const pageCards = cards.slice(i, i + 9);\r\n    const pageImages = imageBytesArr.slice(i, i + 9);\r\n    const page = pdfDoc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);\r\n\r\n    for (let j = 0; j < pageCards.length; j++) {\r\n      const imgBytes = pageImages[j];\r\n      // Embed image (assume PNG)\r\n      const img = await pdfDoc.embedPng(imgBytes);\r\n      const row = Math.floor(j / 3);\r\n      const col = j % 3;\r\n      const x = MARGIN_X + (col * (CARD_WIDTH + CARD_SPACING_X));\r\n      const y = PAGE_HEIGHT - MARGIN_Y - CARD_HEIGHT - (row * (CARD_HEIGHT + CARD_SPACING_Y));\r\n      page.drawImage(img, {\r\n        x,\r\n        y,\r\n        width: CARD_WIDTH,\r\n        height: CARD_HEIGHT,\r\n      });\r\n    }\r\n  }\r\n\r\n  const pdfBytes = await pdfDoc.save();\r\n  // Return as Blob for download\r\n  return new Blob([pdfBytes], { type: 'application/pdf' });\r\n};\r\n\r\nexport const downloadPDF = (pdfBlob, filename = 'mtg-deck.pdf') => {\r\n  const url = URL.createObjectURL(pdfBlob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = filename;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  URL.revokeObjectURL(url);\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}