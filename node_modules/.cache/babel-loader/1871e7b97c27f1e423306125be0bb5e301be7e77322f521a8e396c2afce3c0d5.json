{"ast":null,"code":"import axios from 'axios';\n\n// Parse decklist text into card objects\nexport const parseDecklist = decklistText => {\n  const lines = decklistText.trim().split('\\n');\n  const cards = [];\n  for (const line of lines) {\n    const trimmedLine = line.trim();\n    if (!trimmedLine) continue;\n\n    // Match patterns like \"1x Lightning Bolt (2XM) 123\" or \"1 Lightning Bolt\"\n    const match = trimmedLine.match(/^(\\d+)(?:x\\s*)?(.+?)(?:\\s*\\(([^)]+)\\))?(?:\\s+\\d+)?$/);\n    if (match) {\n      const [, quantity, cardName, setCode] = match;\n      cards.push({\n        quantity: parseInt(quantity),\n        name: cardName.trim(),\n        setCode: setCode ? setCode.trim() : null\n      });\n    }\n  }\n  return cards;\n};\n\n// Fetch card data from Scryfall API\nexport const fetchCardData = async (cardName, setCode = null) => {\n  try {\n    let searchQuery;\n    if (setCode) {\n      // Use exact name search with set filter\n      searchQuery = `!\"${cardName}\" set:${setCode}`;\n    } else {\n      // Use exact name search without set filter\n      searchQuery = `!\"${cardName}\"`;\n    }\n    console.log(`Searching for: ${searchQuery}`);\n    const response = await axios.get(`https://api.scryfall.com/cards/search`, {\n      params: {\n        q: searchQuery,\n        unique: 'cards'\n      }\n    });\n    if (response.data.data && response.data.data.length > 0) {\n      var _card$image_uris, _card$card_faces, _card$card_faces$, _card$card_faces$$ima;\n      const card = response.data.data[0];\n      return {\n        name: card.name,\n        imageUrl: ((_card$image_uris = card.image_uris) === null || _card$image_uris === void 0 ? void 0 : _card$image_uris.png) || ((_card$card_faces = card.card_faces) === null || _card$card_faces === void 0 ? void 0 : (_card$card_faces$ = _card$card_faces[0]) === null || _card$card_faces$ === void 0 ? void 0 : (_card$card_faces$$ima = _card$card_faces$.image_uris) === null || _card$card_faces$$ima === void 0 ? void 0 : _card$card_faces$$ima.png),\n        set: card.set_name,\n        collectorNumber: card.collector_number\n      };\n    }\n    throw new Error(`Card not found: ${cardName}`);\n  } catch (error) {\n    var _error$response, _error$response2, _error$response3, _error$response4;\n    console.log(`Error for ${cardName} in set ${setCode}:`, (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status, (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.statusText);\n\n    // If set-specific search failed, try name-only search\n    if (setCode && (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 404 || ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) === 400)) {\n      try {\n        console.log(`Retrying search for ${cardName} without set code...`);\n        const fallbackResponse = await axios.get(`https://api.scryfall.com/cards/search`, {\n          params: {\n            q: `!\"${cardName}\"`,\n            unique: 'cards'\n          }\n        });\n        if (fallbackResponse.data.data && fallbackResponse.data.data.length > 0) {\n          var _card$image_uris2, _card$card_faces2, _card$card_faces2$, _card$card_faces2$$im;\n          const card = fallbackResponse.data.data[0];\n          console.log(`Found ${cardName} in set ${card.set_name}`);\n          return {\n            name: card.name,\n            imageUrl: ((_card$image_uris2 = card.image_uris) === null || _card$image_uris2 === void 0 ? void 0 : _card$image_uris2.png) || ((_card$card_faces2 = card.card_faces) === null || _card$card_faces2 === void 0 ? void 0 : (_card$card_faces2$ = _card$card_faces2[0]) === null || _card$card_faces2$ === void 0 ? void 0 : (_card$card_faces2$$im = _card$card_faces2$.image_uris) === null || _card$card_faces2$$im === void 0 ? void 0 : _card$card_faces2$$im.png),\n            set: card.set_name,\n            collectorNumber: card.collector_number\n          };\n        }\n      } catch (fallbackError) {\n        var _fallbackError$respon;\n        console.error(`Fallback search also failed for ${cardName}:`, (_fallbackError$respon = fallbackError.response) === null || _fallbackError$respon === void 0 ? void 0 : _fallbackError$respon.status);\n      }\n    }\n    console.error(`Error fetching card ${cardName}:`, error);\n    throw new Error(`Card not found: ${cardName}${setCode ? ` in set ${setCode}` : ''}`);\n  }\n};\n\n// Fetch multiple cards with error handling\nexport const fetchMultipleCards = async cards => {\n  const results = [];\n  const errors = [];\n  for (const card of cards) {\n    try {\n      const cardData = await fetchCardData(card.name, card.setCode);\n      // Add the card multiple times based on quantity\n      for (let i = 0; i < card.quantity; i++) {\n        results.push(cardData);\n      }\n    } catch (error) {\n      errors.push(`${card.name}: ${error.message}`);\n    }\n  }\n  return {\n    results,\n    errors\n  };\n};","map":{"version":3,"names":["axios","parseDecklist","decklistText","lines","trim","split","cards","line","trimmedLine","match","quantity","cardName","setCode","push","parseInt","name","fetchCardData","searchQuery","console","log","response","get","params","q","unique","data","length","_card$image_uris","_card$card_faces","_card$card_faces$","_card$card_faces$$ima","card","imageUrl","image_uris","png","card_faces","set","set_name","collectorNumber","collector_number","Error","error","_error$response","_error$response2","_error$response3","_error$response4","status","statusText","fallbackResponse","_card$image_uris2","_card$card_faces2","_card$card_faces2$","_card$card_faces2$$im","fallbackError","_fallbackError$respon","fetchMultipleCards","results","errors","cardData","i","message"],"sources":["C:/MTG/mtg-pdf-printer/mtg-pdf-printer/src/utils/scryfall.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Parse decklist text into card objects\r\nexport const parseDecklist = (decklistText) => {\r\n  const lines = decklistText.trim().split('\\n');\r\n  const cards = [];\r\n\r\n  for (const line of lines) {\r\n    const trimmedLine = line.trim();\r\n    if (!trimmedLine) continue;\r\n\r\n    // Match patterns like \"1x Lightning Bolt (2XM) 123\" or \"1 Lightning Bolt\"\r\n    const match = trimmedLine.match(/^(\\d+)(?:x\\s*)?(.+?)(?:\\s*\\(([^)]+)\\))?(?:\\s+\\d+)?$/);\r\n    \r\n    if (match) {\r\n      const [, quantity, cardName, setCode] = match;\r\n      cards.push({\r\n        quantity: parseInt(quantity),\r\n        name: cardName.trim(),\r\n        setCode: setCode ? setCode.trim() : null\r\n      });\r\n    }\r\n  }\r\n\r\n  return cards;\r\n};\r\n\r\n// Fetch card data from Scryfall API\r\nexport const fetchCardData = async (cardName, setCode = null) => {\r\n  try {\r\n    let searchQuery;\r\n    \r\n    if (setCode) {\r\n      // Use exact name search with set filter\r\n      searchQuery = `!\"${cardName}\" set:${setCode}`;\r\n    } else {\r\n      // Use exact name search without set filter\r\n      searchQuery = `!\"${cardName}\"`;\r\n    }\r\n\r\n    console.log(`Searching for: ${searchQuery}`);\r\n\r\n    const response = await axios.get(`https://api.scryfall.com/cards/search`, {\r\n      params: {\r\n        q: searchQuery,\r\n        unique: 'cards'\r\n      }\r\n    });\r\n\r\n    if (response.data.data && response.data.data.length > 0) {\r\n      const card = response.data.data[0];\r\n      return {\r\n        name: card.name,\r\n        imageUrl: card.image_uris?.png || card.card_faces?.[0]?.image_uris?.png,\r\n        set: card.set_name,\r\n        collectorNumber: card.collector_number\r\n      };\r\n    }\r\n    \r\n    throw new Error(`Card not found: ${cardName}`);\r\n  } catch (error) {\r\n    console.log(`Error for ${cardName} in set ${setCode}:`, error.response?.status, error.response?.statusText);\r\n    \r\n    // If set-specific search failed, try name-only search\r\n    if (setCode && (error.response?.status === 404 || error.response?.status === 400)) {\r\n      try {\r\n        console.log(`Retrying search for ${cardName} without set code...`);\r\n        const fallbackResponse = await axios.get(`https://api.scryfall.com/cards/search`, {\r\n          params: {\r\n            q: `!\"${cardName}\"`,\r\n            unique: 'cards'\r\n          }\r\n        });\r\n\r\n        if (fallbackResponse.data.data && fallbackResponse.data.data.length > 0) {\r\n          const card = fallbackResponse.data.data[0];\r\n          console.log(`Found ${cardName} in set ${card.set_name}`);\r\n          return {\r\n            name: card.name,\r\n            imageUrl: card.image_uris?.png || card.card_faces?.[0]?.image_uris?.png,\r\n            set: card.set_name,\r\n            collectorNumber: card.collector_number\r\n          };\r\n        }\r\n      } catch (fallbackError) {\r\n        console.error(`Fallback search also failed for ${cardName}:`, fallbackError.response?.status);\r\n      }\r\n    }\r\n    \r\n    console.error(`Error fetching card ${cardName}:`, error);\r\n    throw new Error(`Card not found: ${cardName}${setCode ? ` in set ${setCode}` : ''}`);\r\n  }\r\n};\r\n\r\n// Fetch multiple cards with error handling\r\nexport const fetchMultipleCards = async (cards) => {\r\n  const results = [];\r\n  const errors = [];\r\n\r\n  for (const card of cards) {\r\n    try {\r\n      const cardData = await fetchCardData(card.name, card.setCode);\r\n      // Add the card multiple times based on quantity\r\n      for (let i = 0; i < card.quantity; i++) {\r\n        results.push(cardData);\r\n      }\r\n    } catch (error) {\r\n      errors.push(`${card.name}: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  return { results, errors };\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}