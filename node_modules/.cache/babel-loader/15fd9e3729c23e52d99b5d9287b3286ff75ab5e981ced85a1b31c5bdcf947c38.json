{"ast":null,"code":"import { PDFDocument } from 'pdf-lib';\n\n// Standard Magic card dimensions (2.5\" x 3.5\")\nconst BASE_CARD_WIDTH = 2.5 * 72; // 180pt\nconst BASE_CARD_HEIGHT = 3.5 * 72; // 252pt\n\n// Margins (minimal for cutting)\nconst MARGIN_X = 0.25 * 72; // 18pt\nconst MARGIN_Y = 0.25 * 72; // 18pt\n\nexport const generatePDF = async (cards, paper = {\n  width: 8.5,\n  height: 11.0\n}, scale = 100) => {\n  // Convert inches to points\n  const PAGE_WIDTH = paper.width * 72;\n  const PAGE_HEIGHT = paper.height * 72;\n\n  // Scale card size\n  const scaleFactor = Math.max(90, Math.min(Number(scale), 110)) / 100;\n  const CARD_WIDTH = BASE_CARD_WIDTH * scaleFactor;\n  const CARD_HEIGHT = BASE_CARD_HEIGHT * scaleFactor;\n\n  // Calculate grid spacing\n  const GRID_WIDTH = PAGE_WIDTH - 2 * MARGIN_X;\n  const GRID_HEIGHT = PAGE_HEIGHT - 2 * MARGIN_Y;\n  const CARD_SPACING_X = (GRID_WIDTH - 3 * CARD_WIDTH) / 2;\n  const CARD_SPACING_Y = (GRID_HEIGHT - 3 * CARD_HEIGHT) / 2;\n  const pdfDoc = await PDFDocument.create();\n\n  // Pre-fetch all images as Uint8Array\n  const imageBytesArr = await Promise.all(cards.map(async card => {\n    const response = await fetch(card.imageUrl);\n    const arrayBuffer = await response.arrayBuffer();\n    return new Uint8Array(arrayBuffer);\n  }));\n  for (let i = 0; i < cards.length; i += 9) {\n    const pageCards = cards.slice(i, i + 9);\n    const pageImages = imageBytesArr.slice(i, i + 9);\n    const page = pdfDoc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);\n    for (let j = 0; j < pageCards.length; j++) {\n      const imgBytes = pageImages[j];\n      // Embed image (assume PNG)\n      const img = await pdfDoc.embedPng(imgBytes);\n      const row = Math.floor(j / 3);\n      const col = j % 3;\n      const x = MARGIN_X + col * (CARD_WIDTH + CARD_SPACING_X);\n      const y = PAGE_HEIGHT - MARGIN_Y - CARD_HEIGHT - row * (CARD_HEIGHT + CARD_SPACING_Y);\n      page.drawImage(img, {\n        x,\n        y,\n        width: CARD_WIDTH,\n        height: CARD_HEIGHT\n      });\n    }\n  }\n  const pdfBytes = await pdfDoc.save();\n  // Return as Blob for download\n  return new Blob([pdfBytes], {\n    type: 'application/pdf'\n  });\n};\nexport const downloadPDF = (pdfBlob, filename = 'mtg-deck.pdf') => {\n  const url = URL.createObjectURL(pdfBlob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n};","map":{"version":3,"names":["PDFDocument","BASE_CARD_WIDTH","BASE_CARD_HEIGHT","MARGIN_X","MARGIN_Y","generatePDF","cards","paper","width","height","scale","PAGE_WIDTH","PAGE_HEIGHT","scaleFactor","Math","max","min","Number","CARD_WIDTH","CARD_HEIGHT","GRID_WIDTH","GRID_HEIGHT","CARD_SPACING_X","CARD_SPACING_Y","pdfDoc","create","imageBytesArr","Promise","all","map","card","response","fetch","imageUrl","arrayBuffer","Uint8Array","i","length","pageCards","slice","pageImages","page","addPage","j","imgBytes","img","embedPng","row","floor","col","x","y","drawImage","pdfBytes","save","Blob","type","downloadPDF","pdfBlob","filename","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL"],"sources":["C:/MTG/mtg-pdf-printer/mtg-pdf-printer/src/utils/pdfGenerator.js"],"sourcesContent":["import { PDFDocument } from 'pdf-lib';\n\n// Standard Magic card dimensions (2.5\" x 3.5\")\nconst BASE_CARD_WIDTH = 2.5 * 72; // 180pt\nconst BASE_CARD_HEIGHT = 3.5 * 72; // 252pt\n\n// Margins (minimal for cutting)\nconst MARGIN_X = 0.25 * 72; // 18pt\nconst MARGIN_Y = 0.25 * 72; // 18pt\n\nexport const generatePDF = async (cards, paper = { width: 8.5, height: 11.0 }, scale = 100) => {\n  // Convert inches to points\n  const PAGE_WIDTH = paper.width * 72;\n  const PAGE_HEIGHT = paper.height * 72;\n\n  // Scale card size\n  const scaleFactor = Math.max(90, Math.min(Number(scale), 110)) / 100;\n  const CARD_WIDTH = BASE_CARD_WIDTH * scaleFactor;\n  const CARD_HEIGHT = BASE_CARD_HEIGHT * scaleFactor;\n\n  // Calculate grid spacing\n  const GRID_WIDTH = PAGE_WIDTH - (2 * MARGIN_X);\n  const GRID_HEIGHT = PAGE_HEIGHT - (2 * MARGIN_Y);\n  const CARD_SPACING_X = (GRID_WIDTH - (3 * CARD_WIDTH)) / 2;\n  const CARD_SPACING_Y = (GRID_HEIGHT - (3 * CARD_HEIGHT)) / 2;\n\n  const pdfDoc = await PDFDocument.create();\n\n  // Pre-fetch all images as Uint8Array\n  const imageBytesArr = await Promise.all(\n    cards.map(async (card) => {\n      const response = await fetch(card.imageUrl);\n      const arrayBuffer = await response.arrayBuffer();\n      return new Uint8Array(arrayBuffer);\n    })\n  );\n\n  for (let i = 0; i < cards.length; i += 9) {\n    const pageCards = cards.slice(i, i + 9);\n    const pageImages = imageBytesArr.slice(i, i + 9);\n    const page = pdfDoc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);\n\n    for (let j = 0; j < pageCards.length; j++) {\n      const imgBytes = pageImages[j];\n      // Embed image (assume PNG)\n      const img = await pdfDoc.embedPng(imgBytes);\n      const row = Math.floor(j / 3);\n      const col = j % 3;\n      const x = MARGIN_X + (col * (CARD_WIDTH + CARD_SPACING_X));\n      const y = PAGE_HEIGHT - MARGIN_Y - CARD_HEIGHT - (row * (CARD_HEIGHT + CARD_SPACING_Y));\n      page.drawImage(img, {\n        x,\n        y,\n        width: CARD_WIDTH,\n        height: CARD_HEIGHT,\n      });\n    }\n  }\n\n  const pdfBytes = await pdfDoc.save();\n  // Return as Blob for download\n  return new Blob([pdfBytes], { type: 'application/pdf' });\n};\n\nexport const downloadPDF = (pdfBlob, filename = 'mtg-deck.pdf') => {\n  const url = URL.createObjectURL(pdfBlob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}